# 要件定義・機能仕様書

## 1. ユーザーロールと権限

システムには以下の4つのロールが存在し、それぞれ異なる権限を持ちます。

| ロール                         | 説明                                                   | 猫の新規登録 | [基本情報] の編集 | [医療/譲渡条件] の編集 | 里親申請の管理 |
| :----------------------------- | :----------------------------------------------------- | :----------: | :---------------: | :--------------------: | :------------: |
| **管理者 (Superuser)**         | システム全域の管理権限を持つユーザー。                 |      ✅      |        ✅         |           ✅           |       ✅       |
| **団体管理者 (Shelter Admin)** | 特定の保護団体に所属し、その団体の全てのデータを管理。 |      ✅      |        ✅         |           ✅           |       ✅       |
| **団体スタッフ (Staff)**       | 保護団体の日常業務（情報の更新など）を担当。           |      ❌      |        ✅         |           ❌           |       ❌       |
| **里親候補者 (Adopter)**       | 保護猫を探し、応募する一般ユーザー。                   |      ❌      |        ❌         |           ❌           |       ❌       |

---

## 2. 保護猫管理機能

### 2.1 猫の登録・一覧・編集

- **新規登録**: 団体管理者および管理者のみが可能。
- **基本情報の編集**: 全ての団体スタッフ（管理者含む）が可能。
  - 項目: 名前、性別、年齢区分、推定年齢、品種、体格、毛色。
- **制限項目の編集**: 団体管理者および管理者のみが可能。
  - 項目: 公開ステータス、全体の紹介文、医療情報、譲渡条件、費用など。
- **メディア管理**: 画像（最大複数枚、メイン画像指定可）および動画のアップロード・削除。

### 2.2 公開制御

- **ステータス管理**: 募集中、一時停止、審査中、トライアル中、譲渡済みの5段階。
- **募集範囲**: 団体ごとに設定された都道府県や条件に基づき表示。

---

## 3. 里親申請・コミュニケーション機能

### 3.1 里親申請 (Adoption Application)

- 一般ユーザー（里親候補者）は、気に入った猫に対して申請を送ることができる。
- 申請時にアンケート項目（飼育環境、同意事項など）を入力。
- 同じ猫への重複申請はシステムで制限される。

### 3.2 申請管理 (Shelter Side)

- 団体管理者は届いた申請を一覧で確認し、ステータスを更新できる。
  - ステータスフロー: 応募直後 → 確認/面談調整中 → 成立/不成立/キャンセル。
- 一般スタッフは、誤操作防止のため申請一覧へのアクセスやステータス変更が制限される。

### 3.3 メッセージ機能 (Chat)

- 申請ごとに保護団体と候補者の間で1対1のチャットが可能。
- 送信者タイプ（ユーザー、団体、管理者）が識別され、リアルタイムに近い形式でやり取りを行う。

---

## 4. UI/UX 仕様

### 4.1 デザインコンセプト

- **リッチな視覚体験**: グラデーション、ガラスモルフィズム、モダンなタイポグラフィ（Google Fonts 等）を使用したプレミアムな質感。
- **モバイルファースト**: スマートフォンでの操作性を重視したレスポンシブ設計。

### 4.2 特徴的なUI要素

- **ダッシュボード**: 役割に応じたクイックアクションを表示（スタッフには新規登録ボタンを隠す等）。
- **猫カード**: 4:3のアスペクト比を維持した画像表示、一目でわかるステータスバッジ。
- **エラーハンドリング**: バリデーションエラー時は対象フィールドを表示するアラート等でユーザーをガイド。

---

## 5. 技術仕様 (概要)

### 5.1 API構成

- **Base URL**: `/api/`
- **主なエンドポイント**:
  - `/api/accounts/`: 認証、プロフィール管理
  - `/api/cats/`: 保護猫データの取得・管理
  - `/api/applications/`: 里親申請の管理
  - `/api/messages/`: チャットメッセージの送受信

### 5.2 認証方式

- **JWT (JSON Web Token)** を使用。`access_token` および `refresh_token` によるセッション管理。
